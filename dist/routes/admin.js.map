{"version":3,"sources":["../../routes/admin.js"],"names":["express","require","router","Router","bodyParser","use","json","urlencoded","extended","morgan","Models","req","res","next","url","isAuthenticated","status","message","user","auth","post","promises","body","userList","forEach","authValue","admin","push","User","addUser","firstName","lastName","email","pseudo","password","Promise","all","then","findAll","order","allUserData","userArray","dataValues","id","group_id","success","get","console","log","Sondage","findOne","sondage","Group","addGroup","groupName","where","getGroups","groupList","selectedUsers","promise","resolve","check","update","selectedGroup","getSondage","sondageList","createSondage","sondageId","send","sondage_id","sondage_name","findById","getCommentairesJour","params","jour","comments","getStatistics","statisticTab","getStatisticsSpecific","sondageResult","Keyword","keywords","keywordList","keyword","name","addKeyword","Post","addPost","module","exports"],"mappings":"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","sourcesContent":["const express = require('express');\n\nconst router = express.Router();\n\n// Le body Parser permet d'acceder aux variable envoyés dans le body\nconst bodyParser = require('body-parser');\n\nrouter.use(bodyParser.json());\nrouter.use(express.urlencoded({ extended: false }));\n\nconst morgan = require('morgan');\n\n// Récupère les models\nconst Models = require('../models/index');\n\nrouter.use(morgan('dev'));\n\nrouter.use((req, res, next) => {\n  if (req.url === '/login') {\n    next();\n  } else if (!req.isAuthenticated()) {\n    res.status(401).json({ message: 'Not logged in' });\n  } else if (req.user.auth !== 1) {\n    res.status(401).json({ message: 'Not authorized' });\n  } else {\n    next();\n  }\n});\n\n// --------- Routes protegées par token -------------\n\n// firstName, lastName, email, pseudo, password, auth, photo\nrouter.post('/postUsers',\n  (req, res) => {\n    const promises = [];\n    req.body.userList.forEach((user) => {\n      let authValue = 0;\n      if (user.admin) {\n        authValue = 1;\n      }\n      promises.push(Models.User.addUser(\n        user.firstName,\n        user.lastName,\n        user.email,\n        user.pseudo, \n        user.password, \n        authValue,\n      ));\n    });\n    Promise.all(promises).then(() => {\n      Models.User.findAll({ order: [['createdAt', 'DESC']] }).then((allUserData) => {\n        const userArray = [];\n        allUserData.forEach((user) => {\n          const {\n            firstName, lastName, email, pseudo, id, group_id,\n          } = user.dataValues; \n          userArray.push({\n            firstName: firstName,\n            lastName: lastName,\n            email: email,\n            pseudo: pseudo,\n            id: id,\n            group_id: group_id,\n          });\n        });\n        res.status(200).json({ userArray: userArray, success: true });\n      });\n    });\n  });\n\nrouter.get('/getUsers', (req, res) => {\n  Models.User.findAll({ order: [['createdAt', 'DESC']] }).then((allUserData) => {\n    const userArray = [];\n    allUserData.forEach((user) => {\n      const {\n        firstName, lastName, email, pseudo, id, group_id,\n      } = user.dataValues; \n      userArray.push({\n        firstName: firstName,\n        lastName: lastName,\n        email: email,\n        pseudo: pseudo,\n        id: id,\n        group_id: group_id,\n      });\n    });\n    console.log(userArray);\n    res.json(userArray);\n  });\n});\n\nrouter.post('/postGroup', (req, res) => {\n  Models.Sondage.findOne().then((sondage) => {\n    Models.Group.addGroup(sondage.dataValues.id, req.body.groupName).then(() => {\n      Models.User.findOne({ where: { id: req.user.id } }).then((user) => {\n        user.getGroups().then((groupList) => {\n          console.log(\"Sent all groups to client\");\n          res.status(200).json({ success: true, groupList: groupList });\n        });\n      });\n    });\n  });\n});\n\nrouter.post('/changeUserGroup', (req, res) => {\n  const promises = [];\n  req.body.selectedUsers.forEach((user) => {\n    const promise = new Promise((resolve) => {\n      if (user.check) {\n        Models.User.update({ group_id: req.body.selectedGroup.id }, { where: { id: user.id } })\n          .then(() => {\n            resolve();\n          });\n      } else {\n        resolve();\n      }\n    });\n    promises.push(promise);\n  });\n  Promise.all(promises).then(() => {\n    res.status(200).json({ success: true });\n  });\n});\n// Route relative à l'affichage et la creation de sondage\n\nrouter.get('/getSondage', (req, res) => {\n  Models.User.findOne({ where: { id: req.user.id } }).then((user) => {\n    user.getSondage().then((sondageList) => {\n      res.status(200).json(sondageList);\n    });\n  });\n});\n\nrouter.get('/getGroups', (req, res) => {\n  Models.User.findOne({ where: { id: req.user.id } }).then((user) => {\n    user.getGroups().then((groupList) => {\n      console.log(\"Sent all groups to client\");\n      res.status(200).json(groupList);\n    });\n  });\n});\n\nrouter.post('/postSondage', (req, res) => {\n  Models.User.findOne({ where: { id: req.user.id } }).then((user) => {\n    user.createSondage(req.body).then((sondageId) => {\n      res.json({ sondageId: sondageId });\n    });\n  });\n});\n\nrouter.post('/changeNextSondage', (req, res) => {\n  if (!req.body) {\n    res.status(400).send(\"Bad Request : The body doesnt contain next_sondage ! \");\n  } else {\n    Models.Group.update({ sondage_id: req.body.sondage_id }, { where: { id: req.body.group_id } })\n      .then(() => {\n        console.log(\"Changed the sondage to sondage: \", req.body.sondage_id, \" for the group: \", req.body.sondage_id);\n        res.status(200).json(`Changed the sondage to sondage: ${req.body.sondage_name} for the group: ${req.body.sondage_name}`);\n      });\n  }\n});\n\n// Route relative aux statisques\n\nrouter.get('/getCommentaireJour/:jour', (req, res) => {\n  Models.User.findById(req.user.id).then((user) => {\n    user.getCommentairesJour(req.params.jour).then((comments) => {\n      res.status(200).json(comments);\n    });\n  });\n});\n\nrouter.get(\"/generalStatistics\", (req, res) => {\n  Models.User.findById(req.user.id).then((user) => {\n    user.getStatistics((statisticTab) => {\n      res.json(statisticTab);\n    });\n  });\n});\n\nrouter.get(\"/specificStatistics/:year/:month/:day/:group\", (req, res) => {\n  Models.User.findById(req.user.id).then((user) => {\n    user.getStatisticsSpecific(req.params).then((sondageResult) => {\n      res.json(sondageResult);\n    });\n  });\n});\n\n// Route relative aux aux mot clef\n\nrouter.get(\"/getKeywords\", (req, res) => {\n  Models.Keyword.findAll().then((keywords) => {\n    const keywordList = [];\n    keywords.forEach((keyword) => {\n      keywordList.push(keyword.dataValues.name);\n    });\n    res.status(200).json(keywordList);\n  });\n});\n\nrouter.post(\"/addKeyWord\", (req, res) => {\n  Models.Keyword.addKeyword(req.body.name).then(() => {\n    Models.Keyword.findAll().then((keywords) => {\n      const keywordList = [];\n      keywords.forEach((keyword) => {\n        keywordList.push(keyword.dataValues.name);\n      });\n      res.status(200).json(keywordList);\n    });\n  });\n});\n\n// Route relative aux posts\n\nrouter.post(\"/addPost\", (req, res) => {\n  Models.Post.addPost(req.body.post);\n  res.json({\n    success: true,\n  });\n});\n\nmodule.exports = router;"],"file":"admin.js"}