{"version":3,"sources":["../../passport-config/adminStrategy.js"],"names":["LocalStrategy","require","Strategy","Admin","adminLoginStrategy","usernameField","pseudo","password","done","findOne","where","then","admin","message","validPassword","salt","undefined","hash","module","exports"],"mappings":";;AAAA,IAAMA,aAAa,GAAGC,OAAO,CAAC,gBAAD,CAAP,CAA0BC,QAAhD;;AAEA,IAAMC,KAAK,GAAGF,OAAO,CAAC,iBAAD,CAAP,CAA2BE,KAAzC;;AAEA,IAAMC,kBAAkB,GAAG,IAAIJ,aAAJ,CACzB;AACEK,EAAAA,aAAa,EAAE;AADjB,CADyB,EAIxB,UAACC,MAAD,EAASC,QAAT,EAAmBC,IAAnB,EAA4B;AAC3BL,EAAAA,KAAK,CAACM,OAAN,CAAc;AAAEC,IAAAA,KAAK,EAAE;AAAEJ,MAAAA,MAAM,EAAEA;AAAV;AAAT,GAAd,EAA6CK,IAA7C,CAAkD,UAACC,KAAD,EAAW;AAC3D,QAAI,CAACA,KAAL,EAAY;AACV,aAAOJ,IAAI,CAAC,IAAD,EAAO,WAAP,EAAoB;AAAEK,QAAAA,OAAO,EAAE;AAAX,OAApB,CAAX;AACD;;AACD,QAAI,CAACD,KAAK,CAACE,aAAN,CAAoBP,QAApB,CAAL,EAAoC;AAClC,aAAOC,IAAI,CAAC,IAAD,EAAO,WAAP,EAAoB;AAAEK,QAAAA,OAAO,EAAE;AAAX,OAApB,CAAX;AACD;;AACDD,IAAAA,KAAK,CAACG,IAAN,GAAaC,SAAb;AACAJ,IAAAA,KAAK,CAACK,IAAN,GAAaD,SAAb;AACA,WAAOR,IAAI,CAAC,IAAD,EAAOI,KAAP,CAAX;AACD,GAVD;AAWD,CAhBwB,CAA3B;AAmBAM,MAAM,CAACC,OAAP,GAAiBf,kBAAjB","sourcesContent":["const LocalStrategy = require('passport-local').Strategy;\n\nconst Admin = require(\"../models/index\").Admin;\n\nconst adminLoginStrategy = new LocalStrategy(\n  {\n    usernameField: \"pseudo\",\n  },\n  ((pseudo, password, done) => {\n    Admin.findOne({ where: { pseudo: pseudo } }).then((admin) => {\n      if (!admin) {\n        return done(null, \"wrongUser\", { message: 'Incorrect username.' });\n      }\n      if (!admin.validPassword(password)) {\n        return done(null, \"wrongPass\", { message: 'Incorrect password.' });\n      }\n      admin.salt = undefined;\n      admin.hash = undefined;\n      return done(null, admin);\n    });\n  }),\n);\n\nmodule.exports = adminLoginStrategy;"],"file":"adminStrategy.js"}