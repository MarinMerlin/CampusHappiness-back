{"version":3,"sources":["../../passport-config/userStrategy.js"],"names":["LocalStrategy","require","Strategy","User","userLoginStrategy","usernameField","email","password","done","findOne","where","then","user","message","validPassword","salt","undefined","hash","module","exports"],"mappings":";;AAAA,IAAMA,aAAa,GAAGC,OAAO,CAAC,gBAAD,CAAP,CAA0BC,QAAhD;;AAEA,IAAMC,IAAI,GAAGF,OAAO,CAAC,WAAD,CAAP,CAAqBE,IAAlC;;AAEA,IAAMC,iBAAiB,GAAG,IAAIJ,aAAJ,CACxB;AACEK,EAAAA,aAAa,EAAE;AADjB,CADwB,EAIvB,UAACC,KAAD,EAAQC,QAAR,EAAkBC,IAAlB,EAA2B;AAC1BL,EAAAA,IAAI,CAACM,OAAL,CAAa;AAAEC,IAAAA,KAAK,EAAE;AAAEJ,MAAAA,KAAK,EAAEA;AAAT;AAAT,GAAb,EAA0CK,IAA1C,CAA+C,UAACC,IAAD,EAAU;AACvD,QAAI,CAACA,IAAL,EAAW;AACT,aAAOJ,IAAI,CAAC,IAAD,EAAO,WAAP,EAAoB;AAAEK,QAAAA,OAAO,EAAE;AAAX,OAApB,CAAX;AACD;;AACD,QAAI,CAACD,IAAI,CAACE,aAAL,CAAmBP,QAAnB,CAAL,EAAmC;AACjC,aAAOC,IAAI,CAAC,IAAD,EAAO,WAAP,EAAoB;AAAEK,QAAAA,OAAO,EAAE;AAAX,OAApB,CAAX;AACD;;AACDD,IAAAA,IAAI,CAACG,IAAL,GAAYC,SAAZ;AACAJ,IAAAA,IAAI,CAACK,IAAL,GAAYD,SAAZ;AACA,WAAOR,IAAI,CAAC,IAAD,EAAOI,IAAP,CAAX;AACD,GAVD;AAWD,CAhBuB,CAA1B;AAmBAM,MAAM,CAACC,OAAP,GAAiBf,iBAAjB","sourcesContent":["const LocalStrategy = require('passport-local').Strategy;\n\nconst User = require(\"../models\").User;\n\nconst userLoginStrategy = new LocalStrategy(\n  {\n    usernameField: \"email\",\n  },\n  ((email, password, done) => {\n    User.findOne({ where: { email: email } }).then((user) => {\n      if (!user) {\n        return done(null, \"wrongUser\", { message: 'Incorrect username.' });\n      }\n      if (!user.validPassword(password)) {\n        return done(null, \"wrongPass\", { message: 'Incorrect password.' });\n      }\n      user.salt = undefined;\n      user.hash = undefined;\n      return done(null, user);\n    });\n  }),\n);\n\nmodule.exports = userLoginStrategy;"],"file":"userStrategy.js"}